<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ESTP | Sovereign Minting Authority</title>
    <style>
        :root { --bg: #0d1117; --card: #161b22; --border: #30363d; --text: #c9d1d9; --green: #238636; --blue: #58a6ff; --gold: #d29922; }
        body { background: var(--bg); color: var(--text); font-family: 'Segoe UI', monospace; margin: 0; padding: 20px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        .card { background: var(--card); border: 1px solid var(--border); padding: 15px; border-radius: 8px; }
        .ledger { background: #010409; height: 400px; overflow-y: scroll; padding: 15px; border: 1px solid var(--border); font-size: 0.85em; }
        .status-bar { display: flex; justify-content: space-between; align-items: center; background: var(--card); padding: 10px 20px; border-bottom: 2px solid var(--blue); margin-bottom: 20px; }
        .tag { padding: 4px 8px; border-radius: 4px; font-weight: bold; font-size: 0.7em; margin-right: 5px; }
        .tag-buy { background: var(--blue); color: white; }
        .tag-mint { background: var(--gold); color: black; }
        .tag-settle { background: var(--green); color: white; }
        .stat-val { font-size: 1.5em; font-weight: bold; color: var(--blue); }
    </style>
</head>
<body>

<div class="status-bar">
    <div><strong>BANK MINTING AUTHORITY:</strong> <span style="color:var(--green)">ACTIVE</span></div>
    <div><strong>SYSTEM COLLATERAL:</strong> <span id="collat-ratio">133.33%</span></div>
    <div><strong>BLUE LINE ANCHOR:</strong> $10,000,000.00</div>
</div>

<div class="grid">
    <div class="card">
        <div>PUBLIC LOCKS (TOKEN A)</div>
        <div class="stat-val" id="total-locked">$0.00</div>
        <small>Requirement: 1.33x of Active Loans</small>
    </div>
    <div class="card">
        <div>ACTIVE INDUSTRIAL LOANS (ALI)</div>
        <div class="stat-val" id="active-ali">$0.00</div>
        <small>Hard Cap: $1,000,000.00 (10%)</small>
    </div>
    <div class="card">
        <div>BANK FEE REVENUE (W1)</div>
        <div class="stat-val" id="bank-fees">$0.00</div>
        <small>0.25% Transactional Capture</small>
    </div>
</div>

<div class="card">
    <h3>LIVE TRANSACTION LEDGER (Transparent Commercial Class)</h3>
    <div class="ledger" id="ledger"></div>
</div>

<script>
    // HARD-CODED REGULATOR SETTINGS
    const ANCHOR = 10000000;
    const RED_LINE_CAP = 1000000;
    const LTV_RATIO = 0.75; // 75% LTV = 1.33x Collateral
    
    let stats = {
        locked: 0,
        ali: 0,
        fees: 0,
        tokenC: 0
    };

    function updateUI() {
        document.getElementById('total-locked').innerText = `$${stats.locked.toLocaleString()}`;
        document.getElementById('active-ali').innerText = `$${stats.ali.toLocaleString()}`;
        document.getElementById('bank-fees').innerText = `$${stats.fees.toLocaleString()}`;
    }

    function addLog(tagClass, tagText, msg) {
        const ledger = document.getElementById('ledger');
        const time = new Date().toLocaleTimeString();
        const entry = `<div>[${time}] <span class="tag ${tagClass}">${tagText}</span> ${msg}</div>`;
        ledger.innerHTML = entry + ledger.innerHTML;
    }

    // THE AUTOMATED HEARTBEAT (Every 4 seconds)
    function heartbeat() {
        // 1. SIMULATE PUBLIC PURCHASE & LOCK
        let purchaseAmount = Math.floor(Math.random() * 40000) + 15000;
        
        // CHECK IF WE ARE UNDER THE 10% RED LINE
        if (stats.ali + (purchaseAmount * LTV_RATIO) <= RED_LINE_CAP) {
            stats.locked += purchaseAmount;
            addLog('tag-buy', 'LOCK', `Public locked $${purchaseAmount.toLocaleString()} in Token A (Commercial Account).`);

            // 2. TRIGGER THE MINT (75% of Lock)
            let loanAmount = purchaseAmount * LTV_RATIO;
            stats.ali += loanAmount;
            stats.fees += (loanAmount * 0.0025); // Bank Capture
            addLog('tag-mint', 'MINT', `Bank authorized $${loanAmount.toLocaleString()} ALI to Shipping Alpha.`);

            // 3. SIMULATE THE INDUSTRIAL FLIP (Delayed)
            setTimeout(() => {
                let industrialProfit = loanAmount * 0.072; // 7.2% Markup
                stats.ali -= loanAmount; // Loan Repaid
                addLog('tag-settle', 'FLIP', `Shipment Complete. $${industrialProfit.toLocaleString()} generated. Principal Returned.`);
                addLog('tag-settle', 'ROI', `Distributed 14% ROI in Token C. Token A Units released to user.`);
                updateUI();
            }, 6000);
        } else {
            addLog('tag-buy', 'HOLD', `Red Line Cap reached. Heartbeat queuing next available flip window...`);
        }
        updateUI();
    }

    // Start the machine
    setInterval(heartbeat, 4000);
</script>

</body>
</html>
